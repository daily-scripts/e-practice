{"ast":null,"code":"import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _slicedToArray from\"/Users/xuel/workspace/GitHub/programmer-english/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useCallback,useEffect,useState}from'react';import Header from'components/Header';import Main from'components/Main';import Word from'components/Word';import Translation from'components/Translation';import Speed from'components/Speed';import Modals from'components/Modals';import Loading from'components/Loading';import Phonetic from'components/Phonetic';import PronunciationSwitcher from'./PronunciationSwitcher';import{isLegal,IsDesktop}from'utils/utils';import{useHotkeys}from'react-hotkeys-hook';import{useModals}from'hooks/useModals';import useSwitcherState from'./hooks/useSwitcherState';import Switcher from'./Switcher';import{useWordList}from'./hooks/useWordList';import Layout from'../../components/Layout';import{NavLink}from'react-router-dom';import usePronunciation from'./hooks/usePronunciation';import Tooltip from'components/Tooltip';var App=function App(){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),order=_useState2[0],setOrder=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),inputCount=_useState4[0],setInputCount=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),correctCount=_useState6[0],setCorrectCount=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isStart=_useState8[0],setIsStart=_useState8[1];var _useSwitcherState=useSwitcherState({wordVisible:true,phonetic:false}),_useSwitcherState2=_slicedToArray(_useSwitcherState,2),switcherState=_useSwitcherState2[0],switcherStateDispatch=_useSwitcherState2[1];var wordList=useWordList();var _usePronunciation=usePronunciation(),_usePronunciation2=_slicedToArray(_usePronunciation,2),pronunciation=_usePronunciation2[0],pronunciationDispatch=_usePronunciation2[1];var _useModals=useModals(false,'提示'),modalState=_useModals.modalState,modalTitle=_useModals.title,modalContent=_useModals.content,modalFirstBtn=_useModals.firstButton,modalSecondBtn=_useModals.secondButton,modalThirdBtn=_useModals.thirdButton,thirdBtnHotkey=_useModals.thirdBtnHotkey,setThirdBtnHotkey=_useModals.setThirdBtnHotkey,modalFirstBtnOnclick=_useModals.firstButtonOnclick,modalSecondBtnOnclick=_useModals.secondButtonOnclick,modalThirdBtnOnclick=_useModals.thirdButtonOnclick,setModalState=_useModals.setModalState,setModalMessage=_useModals.setMessage,setModalHandler=_useModals.setHandler;useEffect(function(){// 检测用户设备\nif(!IsDesktop()){setTimeout(function(){alert(' Qwerty Learner 目的为提高键盘工作者的英语输入效率，目前暂未适配移动端，希望您使用桌面端浏览器访问。如您使用的是 Ipad 等平板电脑设备，可以使用外接键盘使用本软件。');},500);}},[]);useHotkeys('enter',function(){if(modalState===false){setIsStart(function(isStart){return!isStart;});}},[modalState]);useEffect(function(){var _document$getElements;var onKeydown=function onKeydown(e){if(isLegal(e.key)&&!e.altKey&&!e.ctrlKey&&!e.metaKey){if(isStart){setInputCount(function(count){return count+1;});}}setIsStart(true);};var onBlur=function onBlur(){if(isStart){setIsStart(false);}};var hjOnclick=function hjOnclick(){setIsStart(false);};window.addEventListener('blur',onBlur);window.addEventListener('keydown',onKeydown);(_document$getElements=document.getElementsByClassName('_hj_feedback_container')[0])===null||_document$getElements===void 0?void 0:_document$getElements.addEventListener('click',hjOnclick);return function(){var _document$getElements2;window.removeEventListener('keydown',onKeydown);window.removeEventListener('blur',onBlur);(_document$getElements2=document.getElementsByClassName('_hj_feedback_container')[0])===null||_document$getElements2===void 0?void 0:_document$getElements2.removeEventListener('click',hjOnclick);};},[isStart]);var modalHandlerGenerator=function modalHandlerGenerator(chapter,order,modalState){return function(){setOrder(order);wordList===null||wordList===void 0?void 0:wordList.setChapterNumber(chapter);setModalState(modalState);setIsStart(true);};};var onFinish=function onFinish(){if(wordList===undefined){return;}if(order===wordList.words.length-1){setIsStart(false);// 用户完成当前章节\nif(wordList.chapter===wordList.chapterListLength-1){setModalState(true);setModalMessage('提示','您已完成最后一个章节','重置到第一章节','重复本章节','默写本章节');setThirdBtnHotkey('v');setModalHandler(modalHandlerGenerator(0,0,false),modalHandlerGenerator(wordList.chapter,0,false),function(){modalHandlerGenerator(wordList.chapter,0,false)();switcherStateDispatch('wordVisible',false);setIsStart(true);});}else{setModalState(true);setModalMessage('提示','您已完成本章节','下一章节','重复本章节','默写本章节');setThirdBtnHotkey('v');setModalHandler(modalHandlerGenerator(wordList.chapter+1,0,false),modalHandlerGenerator(wordList.chapter,0,false),function(){modalHandlerGenerator(wordList.chapter,0,false)();switcherStateDispatch('wordVisible',false);setIsStart(true);});}}else{setOrder(function(order){return order+1;});setCorrectCount(function(count){return count+wordList.words[order].name.trim().length;});}};var changePronunciation=useCallback(function(state){pronunciationDispatch(state);},[pronunciationDispatch]);return/*#__PURE__*/_jsxs(_Fragment,{children:[modalState&&/*#__PURE__*/_jsx(Modals,{state:modalState,title:modalTitle,content:modalContent,firstButton:modalFirstBtn,secondButton:modalSecondBtn,thirdButton:modalThirdBtn,thirdButtonHotkey:thirdBtnHotkey,firstButtonOnclick:modalFirstBtnOnclick,secondButtonOnclick:modalSecondBtnOnclick,thirdButtonOnclick:modalThirdBtnOnclick}),wordList===undefined?/*#__PURE__*/_jsx(Loading,{}):/*#__PURE__*/_jsxs(Layout,{children:[/*#__PURE__*/_jsxs(Header,{children:[/*#__PURE__*/_jsx(Tooltip,{content:\"\\u8BCD\\u5178\\u7AE0\\u8282\\u5207\\u6362\",children:/*#__PURE__*/_jsxs(NavLink,{className:\"text-lg px-4 py-1 rounded-lg transition-colors duration-300 ease-in-out focus:outline-none dark:text-white dark:text-opacity-60 hover:bg-indigo-400 hover:text-white dark:hover:text-opacity-100\",to:\"/gallery\",children:[wordList.dictName,\" \\u7B2C \",wordList.chapter+1,\" \\u7AE0\"]})}),/*#__PURE__*/_jsx(PronunciationSwitcher,{state:pronunciation.toString(),changePronunciationState:changePronunciation}),/*#__PURE__*/_jsx(Switcher,{state:switcherState,dispatch:switcherStateDispatch}),/*#__PURE__*/_jsx(Tooltip,{content:\"\\u5FEB\\u6377\\u952E Enter\",children:/*#__PURE__*/_jsx(\"button\",{className:\"\".concat(isStart?'bg-gray-300 dark:bg-gray-700':'bg-indigo-400',\"  text-white dark:text-opacity-80 transition-colors duration-300 text-lg w-20 px-6 py-1 rounded-lg focus:outline-none flex items-center justify-center\"),onClick:function onClick(e){setIsStart(function(isStart){return!isStart;});},children:isStart?'Pause':'Start'})})]}),/*#__PURE__*/_jsx(Main,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"container h-full relative flex mx-auto flex-col items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-1/3\"}),!isStart&&/*#__PURE__*/_jsx(\"h3\",{className:\"pb-4 text-xl text-gray-600 dark:text-gray-50 animate-pulse\",children:\"\\u6309\\u4EFB\\u610F\\u952E\\u5F00\\u59CB\"}),isStart&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Word,{word:wordList.words[order].name,onFinish:onFinish,isStart:isStart,wordVisible:switcherState.wordVisible},\"word-\".concat(wordList.words[order].name,\"-\").concat(order)),switcherState.phonetic&&(wordList.words[order].usphone||wordList.words[order].ukphone)&&/*#__PURE__*/_jsx(Phonetic,{usphone:wordList.words[order].usphone,ukphone:wordList.words[order].ukphone}),/*#__PURE__*/_jsx(Translation,{trans:wordList.words[order].trans.join('；')},\"trans-\".concat(wordList.words[order].name))]}),/*#__PURE__*/_jsx(Speed,{correctCount:correctCount,inputCount:inputCount,isStart:isStart})]})})]})]});};export default App;","map":null,"metadata":{},"sourceType":"module"}